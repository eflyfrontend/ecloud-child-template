(window["webpackJsonp_user"]=window["webpackJsonp_user"]||[]).push([["chunk-04f991f0"],{2372:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list-container text-color-regular"},[a("page-header",{attrs:{title:"部门列表",titleIcon:"icon-groupnotice"}}),a("div",{staticClass:"list-content box"},[a("multi-select",{attrs:{height:t.height-100+"px",data:t.list.nav,label:"name",children:"children"},on:{select:function(e){return t.multiSelect(e)},add:function(e){return t.multiAdd(e)},modify:function(e){return t.multiModify(e)},destroy:function(e){return t.mulitDestroy(e)}}}),a("div",{staticClass:"list-box flex mar-l-default",staticStyle:{display:"inline-table"}},[a("div",{staticClass:"list-serach"},[a("div",{staticClass:"list-serach-left"}),a("div",{staticClass:"list-serach-right"},[a("efly-screen",[a("div",{attrs:{slot:"label"},slot:"label"},[a("efly-select",{attrs:{size:"small",width:"100px",type:"screen",value:"部门",height:"auto"},on:{change:function(e){return t.labelChange(e)}}})],1),t._t("default",(function(){return[a("efly-input",{attrs:{size:"small",placeholder:"请输入部门"},model:{value:t.departmentText,callback:function(e){t.departmentText=e},expression:"departmentText"}})]}))],2),a("efly-button",{staticClass:"btn-primary mar-l-xs",attrs:{size:"small"},on:{click:function(e){return t.serach()}}},[t._v("搜索 ")])],1)]),a("div",{staticClass:"list-data"},[a("efly-table",{attrs:{data:t.list.data,status:t.status.data,loadingImg:t.$loadingImg,nodataIcon:"icon-nodata"}},[a("efly-table-column",{attrs:{header:"部门名称",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"box flex-align-center pad-lr-small",style:"text-indent:"+15*e.data.index+"px"},[t._v(" "+t._s(e.data.name)+" ")])}}])}),a("efly-table-column",{attrs:{header:"成员（个）",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[t._v(" "+t._s(e.data.staffList.length)+" ")])}}])}),a("efly-table-column",{attrs:{header:"备注",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[t._v(" "+t._s(e.data.remark?e.data.remark:"-")+" ")])}}])}),a("efly-table-column",{attrs:{show:t.$authority.EDepartment.modifyMember,header:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"box flex-center"},[a("efly-button",{staticClass:"efly-button-auto",attrs:{size:"small"},on:{click:function(a){return t.skip("member",e.data)}}},[t._v(" 添加/移除成员 ")])],1)}}])})],1)],1)])],1),a("easy-operate",{attrs:{show:t.component.easyOperate,prop:t.easyOperate.id,data:t.easyOperate.data,icon:t.easyOperate.icon,title:t.easyOperate.title},on:{confirm:function(e){return t.easyOperateConfirm(e)}}}),a("department-add",{attrs:{show:t.component.departmentAdd,department:t.department},on:{success:function(e){return t.getList("init")}}}),a("department-modify",{attrs:{show:t.component.departmentModify,department:t.department},on:{success:function(e){return t.getList("init")}}})],1)},s=[],i=a("d4ec"),r=a("bee2"),l=a("262e"),o=a("2caf"),c=(a("b0c0"),a("9ab4")),d=a("1b40"),u=a("65a1"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"popup-container layer-display",attrs:{id:"department-modify"}},[a("div",{staticClass:"popup-item"},[a("div",{staticClass:"popup-item-label"},[t._v("部门名称：")]),a("efly-tooltip",{staticClass:"box flex-column",staticStyle:{width:"100%"},attrs:{content:t.errorMsg.name,trigger:t.errorMsg.name?"show":"hide",position:"relative",top:"2px",left:"2px",placement:"bottom-left"}},[a("div",{staticClass:"popup-item-content box"},[a("efly-input",{attrs:{size:"small",width:"100%",placeholder:"请输入部门名称"},on:{change:function(e){return t.checkName()}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),a("span",{staticClass:"box flex-center color-danger font-default pad-lr-xs"},[t._v("*")])],1)])],1),a("div",{staticClass:"popup-item"},[a("div",{staticClass:"popup-item-label"},[t._v("备注：")]),a("div",{staticClass:"popup-item-content box"},[a("efly-input",{attrs:{type:"textarea",size:"small",width:"100%",placeholder:"请输入备注"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}}),a("span",{staticClass:"box flex-center color-danger font-default pad-lr-xs"})],1)])]):t._e()},m=[],h=a("bd30"),f=function(t){Object(l["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.userID="",t.name="",t.remark="",t.errorMsg={name:""},t}return Object(r["a"])(a,[{key:"mounted",value:function(){this.userID=h["a"].getUserID("ecp")}},{key:"init",value:function(){this.name=this.department.name,this.remark=this.department.remark}},{key:"watchDepartment",value:function(t){}},{key:"watchShow",value:function(t){var e=this;!0===t&&(this.init(),this.layerIndex=this.$layer.open({title:"编辑部门",id:"department-modify",icon:"icon-modify-alias",area:{width:"550px"},btn:{confirm:"确定",cancel:"取消"},confirm:function(){e.submit()},cancel:function(){e.layerClose()}}))}},{key:"checkName",value:function(){return""===this.name?(this.errorMsg.name="请输入部门名称。",!1):(this.errorMsg.name="",!0)}},{key:"submit",value:function(){var t=this;if(this.checkName()){var e=this.$layer.load({message:"正在编辑部门中..."}),a={name:this.name,id:this.department.id,remark:this.remark,userID:this.userID,parentID:this.department.parentID};u["a"].request("/user/department/update",a).then((function(a){t.$layer.close(e),t.layerClose(),t.$emit("success")})).catch((function(a){t.$layer.close(e),t.$layer.msg(a.errorMsg,{type:"error"})}))}}},{key:"layerClose",value:function(){var t=this.$parent;this.$layer.close(this.layerIndex),t.component.departmentModify=!1}}]),a}(d["d"]);Object(c["a"])([Object(d["c"])({default:function(){return!1}})],f.prototype,"show",void 0),Object(c["a"])([Object(d["c"])({default:function(){return""}})],f.prototype,"department",void 0),Object(c["a"])([Object(d["e"])("department",{immediate:!0})],f.prototype,"watchDepartment",null),Object(c["a"])([Object(d["e"])("show",{immediate:!0})],f.prototype,"watchShow",null),f=Object(c["a"])([d["a"]],f);var y=f,v=y,b=v,g=a("2877"),k=Object(g["a"])(b,p,m,!1,null,"2f246948",null),x=k.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"popup-container layer-display",attrs:{id:"department-add"}},[a("div",{staticClass:"popup-item"},[a("div",{staticClass:"popup-item-label"},[t._v("部门名称：")]),a("efly-tooltip",{staticClass:"box flex-column",staticStyle:{width:"100%"},attrs:{content:t.errorMsg.name,trigger:t.errorMsg.name?"show":"hide",position:"relative",top:"2px",left:"2px",placement:"bottom-left"}},[a("div",{staticClass:"popup-item-content box"},[a("efly-input",{attrs:{size:"small",width:"100%",placeholder:"请输入部门名称"},on:{change:function(e){return t.checkName()}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),a("span",{staticClass:"box flex-center color-danger font-default pad-lr-xs"},[t._v("*")])],1)])],1),a("div",{staticClass:"popup-item"},[a("div",{staticClass:"popup-item-label"},[t._v("备注：")]),a("div",{staticClass:"popup-item-content box"},[a("efly-input",{attrs:{type:"textarea",size:"small",width:"100%",placeholder:"请输入备注"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}}),a("span",{staticClass:"box flex-center color-danger font-default pad-lr-xs"})],1)])]):t._e()},w=[],C=function(t){Object(l["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.userID="",t.name="",t.remark="",t.errorMsg={name:""},t}return Object(r["a"])(a,[{key:"mounted",value:function(){this.userID=h["a"].getUserID("ecp")}},{key:"init",value:function(){this.name="",this.remark=""}},{key:"watchDepartment",value:function(t){}},{key:"watchShow",value:function(t){var e=this;!0===t&&(this.init(),this.layerIndex=this.$layer.open({title:"新增部门",id:"department-add",icon:"icon-add-box",area:{width:"550px"},btn:{confirm:"确定",cancel:"取消"},confirm:function(){e.submit()},cancel:function(){e.layerClose()}}))}},{key:"checkName",value:function(){return""===this.name?(this.errorMsg.name="请输入部门名称。",!1):(this.errorMsg.name="",!0)}},{key:"submit",value:function(){var t=this;if(this.checkName()){var e=this.$layer.load({message:"正在新建部门中..."}),a={name:this.name,parentID:this.department.id,remark:this.remark,userID:this.userID};u["a"].request("/user/department/add",a).then((function(a){t.$layer.close(e),t.layerClose(),t.$emit("success")})).catch((function(a){t.$layer.close(e),t.$layer.msg(a.errorMsg,{type:"error"})}))}}},{key:"layerClose",value:function(){var t=this.$parent;this.$layer.close(this.layerIndex),t.component.departmentAdd=!1}}]),a}(d["d"]);Object(c["a"])([Object(d["c"])({default:function(){return!1}})],C.prototype,"show",void 0),Object(c["a"])([Object(d["c"])({default:function(){return""}})],C.prototype,"department",void 0),Object(c["a"])([Object(d["e"])("department",{immediate:!0})],C.prototype,"watchDepartment",null),Object(c["a"])([Object(d["e"])("show",{immediate:!0})],C.prototype,"watchShow",null),C=Object(c["a"])([d["a"]],C);var j=C,_=j,D=_,$=Object(g["a"])(D,O,w,!1,null,"3ab2343a",null),I=$.exports,M=function(t){Object(l["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.list={accountStatus:["全部","已启用","已禁用"],nav:[],data:[]},t.component={easyOperate:!1,departmentModify:!1,departmentAdd:!1},t.status={nav:"loading",data:"loading",serach:"text"},t.page={total:0,start:0,length:10},t.easyOperate={data:[],data2:[],icon:"",title:""},t.department="",t.departmentText="",t.departmentNav="",t}return Object(r["a"])(a,[{key:"created",value:function(){this.userID=h["a"].getUserID(),this.getList(),this.height=document.getElementById("subapp-viewport").clientHeight}},{key:"findMoreOperate",value:function(t){}},{key:"mounted",value:function(){var t=this.$children;for(var e in t)"multi-select"===t[e].$options._componentTag&&(this.mulitSelect=t[e])}},{key:"serach",value:function(){this.departmentNav="",this.status.serach="text",this.mulitSelect.init(),this.getList("serach")}},{key:"multiSelect",value:function(t){this.departmentNav=t.name,this.status.serach="nav",this.departmentText="",this.getList("serach")}},{key:"multiAdd",value:function(t){this.department=t,this.component.departmentAdd=!0}},{key:"multiModify",value:function(t){this.department=t,this.component.departmentModify=!0}},{key:"getList",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"init";this.status.data="loading";var a={};u["a"].request("/user/department/query",a).then((function(a){if("init"===e&&(t.list.nav=a.data.list,t.status.nav=0===a.data.count?"nodata":"havedata"),t.list.data=[],t.list.data2=[],t.getListData(a.data.list,0),"text"===t.status.serach)if(t.departmentText)for(var n in t.list.data2)-1!==t.list.data2[n].name.indexOf(t.departmentText)&&t.list.data.push(t.list.data2[n]);else t.list.data=t.list.data2;else{var s=-1;for(var i in t.list.data2){if(t.list.data2[i].index===s)break;t.list.data2[i].index>s&&-1!==s&&t.list.data.push(t.list.data2[i]),t.list.data2[i].name===t.departmentNav&&(s=t.list.data2[i].index,t.list.data.push(t.list.data2[i]))}}t.status.data=0===a.data.count?"nodata":"havedata",t.page.total=a.data.count})).catch((function(e){console.log(e),t.status.data="error"}))}},{key:"getListData",value:function(t,e){for(var a in t){t[a]["index"]=e;var n=e+1;this.list.data2.push(t[a]),t[a].children.length>0&&this.getListData(t[a].children,n)}}},{key:"mulitDestroy",value:function(t){this.department=t,this.easyOperateOpen("destroy")}},{key:"easyOperateOpen",value:function(t){switch(this.easyOperate.id=t,t){case"destroy":this.easyOperate.title="销毁部门",this.easyOperate.icon="icon-destroy",this.easyOperate.data=[{type:"info",label:"部门",value:[this.department.name]}];break}this.component.easyOperate=!0}},{key:"easyOperateConfirm",value:function(t){switch(t){case"destroy":this.destroy(t);break}}},{key:"destroy",value:function(t){var e=this,a=this.$layer.load({message:"正在删除部门中..."}),n={id:this.department.id,userID:this.userID};u["a"].request("/user/department/delete",n).then((function(t){e.$layer.close(a),e.$layer.msg("删除成功...",{type:"success"}),e.getList("init")})).catch((function(t){e.$layer.close(a),e.$layer.msg(t.errorMsg,{type:"error"})}))}},{key:"skip",value:function(t,e){var a;switch(e&&(this.department=e),t){case"member":a="/user/department/member/"+this.department.id;break}this.$router.push({path:a})}}]),a}(d["d"]);M=Object(c["a"])([Object(d["a"])({components:{DepartmentModify:x,DepartmentAdd:I}})],M);var S=M,L=S,N=L,T=Object(g["a"])(N,n,s,!1,null,"306ec61b",null);e["default"]=T.exports},b0c0:function(t,e,a){var n=a("83ab"),s=a("5e77").EXISTS,i=a("e330"),r=a("9bf2").f,l=Function.prototype,o=i(l.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,d=i(c.exec),u="name";n&&!s&&r(l,u,{configurable:!0,get:function(){try{return d(c,o(this))[1]}catch(t){return""}}})}}]);