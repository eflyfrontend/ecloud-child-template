(window["webpackJsonp_user"]=window["webpackJsonp_user"]||[]).push([["chunk-9a0e8df8"],{b0c0:function(t,e,a){var s=a("83ab"),i=a("5e77").EXISTS,n=a("e330"),o=a("9bf2").f,r=Function.prototype,l=n(r.toString),u=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,d=n(u.exec),c="name";s&&!i&&o(r,c,{configurable:!0,get:function(){try{return d(u,l(this))[1]}catch(t){return""}}})},fb6a:function(t,e,a){"use strict";var s=a("23e7"),i=a("da84"),n=a("e8b5"),o=a("68ee"),r=a("861d"),l=a("23cb"),u=a("07fa"),d=a("fc6a"),c=a("8418"),p=a("b622"),f=a("1dde"),v=a("f36a"),h=f("slice"),y=p("species"),m=i.Array,g=Math.max;s({target:"Array",proto:!0,forced:!h},{slice:function(t,e){var a,s,i,p=d(this),f=u(p),h=l(t,f),b=l(void 0===e?f:e,f);if(n(p)&&(a=p.constructor,o(a)&&(a===m||n(a.prototype))?a=void 0:r(a)&&(a=a[y],null===a&&(a=void 0)),a===m||void 0===a))return v(p,h,b);for(s=new(void 0===a?m:a)(g(b-h,0)),i=0;h<b;h++,i++)h in p&&c(s,i,p[h]);return s.length=i,s}})},fc63:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return"havedata"===t.status.version?a("div",{staticClass:"system-version-container text-color-regular"},[a("page-header",{attrs:{title:"版本信息",titleIcon:"icon-vm"}}),a("div",{staticClass:"pad-lr-default pad-t-default box flex-align-center text-color-secondary"},[a("div",[t._v("当前版本："),a("span",{staticClass:"text-color-regular"},[t._v("v"+t._s(t.version.currentVersion))])]),a("div",{staticClass:"mar-l-default"},[t._v("最新版本："),a("span",{staticClass:"text-color-regular"},[t._v("v"+t._s(t.version.newVersion))])]),t.$authority.EVersion.update&&t.version.currentVersion!==t.version.newVersion?a("efly-button",{staticClass:"btn-outline-primary mar-l-default",attrs:{size:"small"},on:{click:function(e){return t.updateVersion()}}},[t._v("立即更新")]):t._e()],1),a("div",{staticClass:"detail-container"},[a("div",{staticClass:"detail-content"},[t.$authority.EVersion.upload?a("div",{staticClass:"detail-box",staticStyle:{width:"100%",padding:"10px 20px 0 20px"}},[t._m(0),a("div",{staticClass:"popup-container pad-b-default"},[a("div",{staticClass:"popup-item"},[a("div",{staticClass:"popup-item-label"},[t._v("选择文件:")]),a("div",{staticClass:"popup-item-content flex-column"},[a("div",{staticClass:"upload-container box"},[a("div",{staticClass:"upload-file"},[t.file?t._e():a("span",[t._v("请选择上传文件")]),t.file?a("span",{staticClass:"text-primary"},[t._v(t._s(t.file.name))]):t._e(),a("input",{staticClass:"upload-input",attrs:{id:"file",type:"file"},on:{change:function(e){return t.getFile(e)}}}),a("i",{staticClass:"icon icon-folder-face"})]),a("div",{staticClass:"box"},[a("efly-button",{staticClass:"btn-primary mar-l-mini",attrs:{size:"small",disabled:"underway"===t.status.upload},on:{click:function(e){return t.uploadFile()}}},[t._v(" "+t._s("underway"===t.status.upload?"上传中":"上传")+" ")])],1)]),"underway"===t.status.upload?a("div",{staticClass:"box flex-align-center mar-t-mini"},[a("efly-progress",{staticClass:"mar-r-mini",attrs:{color:"#009FEF",width:"300px",percentage:t.upload.percentage}}),a("span",[t._v(t._s(t.upload.percentage)+"%")])],1):t._e()])])])]):t._e(),a("div",{staticClass:"detail-box mar-t-default",staticStyle:{width:"100%",padding:"10px 20px"}},[t._m(1),a("div",{staticClass:"detail-info pad-b-mini"},[a("efly-table",{attrs:{data:t.list.data,status:t.status.data,loadingImg:t.$loadingImg,nodataIcon:"icon-nodata"}},[a("efly-table-column",{attrs:{prop:"version",header:"更新版本",width:"180"}}),a("efly-table-column",{attrs:{prop:"updateTime",header:"更新时间",width:"180"}}),a("efly-table-column",{attrs:{width:"180",header:"更新结果"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"box flex-center"},[a("i",{staticClass:"icon mar-r-xs",class:1===e.data.status?"icon-circle-success color-success":"icon-deep-error color-danger"}),a("span",[t._v(t._s(1===e.data.status?"成功":"失败"))])])}}],null,!1,2529324976)}),a("efly-table-column",{attrs:{header:"操作人",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"box flex-center"},[a("span",[t._v(t._s(e.data.trueName?e.data.trueName:"-"))])])}}],null,!1,4263939430)})],1)],1)])])])],1):t._e()},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail-header"},[a("div",{staticClass:"detail-header-title"},[a("i",{staticClass:"icon icon-info"}),t._v(" 基本信息 ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail-header"},[a("div",{staticClass:"detail-header-title"},[a("i",{staticClass:"icon icon-info"}),t._v(" 更新记录 ")])])}],n=a("d4ec"),o=a("bee2"),r=a("262e"),l=a("2caf"),u=(a("b0c0"),a("fb6a"),a("d3b7"),a("25f0"),a("9ab4")),d=a("1b40"),c=a("65a1"),p=a("bd30"),f=a("151b"),v=function(t){Object(r["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.file="",t.list={data:[]},t.status={version:"loading",data:"loading",upload:"wait"},t.upload={start:0,end:0,size:f["a"].UPLOAD_FILE_MAX,uuid:"",count:0,index:0,percentage:0},t.component={replaceAuthorizationInfo:!1},t}return Object(o["a"])(a,[{key:"created",value:function(){this.userID=p["a"].getAdminUserID(),this.ewalkToken=p["a"].getUserToken(),this.getData(),this.getList()}},{key:"mounted",value:function(){}},{key:"getData",value:function(){var t=this;this.status.version="loading";var e={userID:this.userID};c["a"].request("/system/version/getVersionInfo",e).then((function(e){t.version=e.data,t.status.version="havedata"})).catch((function(e){t.status.version="error"}))}},{key:"getList",value:function(){var t=this;this.status.data="loading";var e={userID:this.userID};c["a"].request("/system/version/queryHistoryList",e).then((function(e){t.list.data=e.data.list,t.status.data=0===e.data.count?"nodata":"havedata"})).catch((function(e){t.status.data="error"}))}},{key:"replace",value:function(){this.component.replaceAuthorizationInfo=!0}},{key:"updateVersion",value:function(){var t=this,e=this.$layer.load({message:"正在更新版本中..."}),a={};c["a"].request("/system/version/upgrade",a).then((function(a){t.$layer.close(e),t.$layer.msg("更新成功",{type:"success"}),t.getData()})).catch((function(a){t.$layer.close(e),t.$layer.msg(a.errorMsg,{type:"error"})}))}},{key:"getFile",value:function(t){this.file=document.getElementById("file").files[0]}},{key:"uploadFile",value:function(){this.file&&this.beforeUpload()}},{key:"beforeUpload",value:function(){var t=this;this.status.upload="underway";var e={size:this.file.size,fileName:this.file.name,userID:this.userID};c["a"].request("/system/version/beforeUploadUpdatePacket",e).then((function(e){t.upload.uuid=e.data.uuid,t.upload.count=Math.ceil(t.file.size/t.upload.size),t.startUpload()})).catch((function(e){t.initUpload(),t.$layer.msg(e.errorMsg,{type:"error"})}))}},{key:"startUpload",value:function(){var t=this;this.upload.end=this.upload.start+this.upload.size;var e=this.file.slice(this.upload.start,this.upload.end),a=new FormData;a.append("file",e),a.append("uuid",this.upload.uuid),a.append("userID",this.userID),a.append("ewalkToken",this.ewalkToken),c["a"].upload("/system/version/uploadUpdatePacket",a).then((function(e){t.upload.end>=t.file.size?(t.upload.percentage=100,t.initUpload(),t.getData(),t.$layer.msg("上传成功",{type:"success"})):(t.upload.index++,t.upload.percentage=parseInt((t.upload.index/t.upload.count*100).toString()),t.upload.start=t.upload.end,t.startUpload())})).catch((function(e){console.log(e),t.initUpload(),t.$layer.msg("上传失败",{type:"error"})}))}},{key:"initUpload",value:function(){this.upload.start=0,this.upload.index=0,this.upload.percentage=0,this.status.upload="wait"}}]),a}(d["d"]);v=Object(u["a"])([Object(d["a"])({})],v);var h=v,y=h,m=y,g=a("2877"),b=Object(g["a"])(m,s,i,!1,null,"87e08732",null);e["default"]=b.exports}}]);